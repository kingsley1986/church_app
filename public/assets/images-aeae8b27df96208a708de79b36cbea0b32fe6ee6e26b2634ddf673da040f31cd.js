document.addEventListener("turbolinks:load",function(){function l(a){-1==a?$("#lightbox li.active").prev().trigger("click"):1==a?$("#lightbox li.active").next().trigger("click"):0==a&&($("#lightbox li.active").removeClass("active"),$(".lb_canvas").removeClass("loading"),$(".lb_backdrop, .lb_canvas, .lb_controls").fadeOut("slow",function(){$(".lb_canvas, .lb_title").html("")}),r=!1)}var a,t,i,n,s,e,c,o,d,b,v,r=!1,_=$(document);$("#lightbox li").click(function(){if(r)return!1;(r=!0,a=$(this),t=a.find("img"),i=a.find(".title").html(),$("#lightbox li.active").removeClass("active"),a.addClass("active"),(n=new Image).src=t.attr("datalarge")?t.attr("datalarge"):t.attr("src"),$(".lb_backdrop").length<1)&&$('<div class="lb_backdrop"></div>'+'<div class="lb_canvas"></div>'+('<div class="lb_controls">'+'<span class="lb_previous"><</span>'+'<span class="lb_title"></span>'+'<span class="lb_next">></span>'+"</div>")).appendTo("body");0==$(".lb_backdrop:visible").length&&$(".lb_backdrop, .lb_canvas, .lb_controls").fadeIn("slow"),n.complete||$(".lb_canvas").addClass("loading").children().css("opacity","0.5"),0==a.prev().length?$(".lb_previous").addClass("inactive"):$(".lb_previous").removeClass("inactive"),0==a.next().length?$(".lb_next").addClass("inactive"):$(".lb_next").removeClass("inactive"),s=$(".lb_canvas").outerWidth(),e=$(".lb_canvas").outerHeight(),c=($(window).width()-s)/2,o=($(window).height()-e)/2,$(".lb_canvas").css({top:o,left:c}),$(n).load(function(){s=n.width,e=n.height,d=parseInt($(".lb_canvas").css("paddingLeft"))+parseInt($(".lb_canvas").css("paddingRight")),b=parseInt($(".lb_canvas").css("paddingTop"))+parseInt($(".lb_canvas").css("paddingBottom")),c=($(window).width()-s-d)/2,o=($(window).height()-e-b)/2,$(".lb_canvas").html("").animate({width:s,height:e,top:o,left:c},500,function(){v='<img src="'+n.src+'" style="opacity: 0;" />',$(".lb_canvas").html(v),$(".lb_canvas img").fadeTo("slow",1),$(".lb_title").html(i),r=!1,$(".lb_canvas").removeClass("loading")})})}),_.on("click",".lb_previous",function(){l(-1)}),_.on("click",".lb_next",function(){l(1)}),_.on("click",".lb_backdrop",function(){l(0)}),_.keyup(function(a){1==$(".lb_backdrop:visible").length&&("37"==a.keyCode?l(-1):"39"==a.keyCode?l(1):"27"==a.keyCode&&l(0))})});